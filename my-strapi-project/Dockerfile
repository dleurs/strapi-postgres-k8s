FROM node:13-alpine

RUN mkdir -p /usr/src/app

WORKDIR /usr/src/app

ARG HOST
ENV HOST=$HOST
ARG PORT
ENV PORT=$PORT
ARG DATABASE_HOST
ENV DATABASE_HOST=$DATABASE_HOST
ARG DATABASE_PORT
ENV DATABASE_PORT=$DATABASE_PORT
ARG DATABASE_NAME
ENV DATABASE_NAME=$DATABASE_NAME
ARG DATABASE_USERNAME
ENV DATABASE_USERNAME=$DATABASE_USERNAME
ARG DATABASE_PASSWORD
ENV DATABASE_PASSWORD=$DATABASE_PASSWORD
ARG DATABASE_SSL
ENV DATABASE_SSL=$DATABASE_SSL
ARG ADMIN_JWT_SECRET
ENV ADMIN_JWT_SECRET=$ADMIN_JWT_SECRET

RUN echo "Database username ${DATABASE_USERNAME}"

COPY package.json .
RUN npm install

COPY . .

EXPOSE 1337
CMD ["npm","run","develop"]
